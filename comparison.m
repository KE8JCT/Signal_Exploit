%You need new, consistent data. Play around with antenna distances because
%gain seriosly screws values up. Possibly stick microcontroller in hallway
%for further reception

clear all

control_signal = abs(loadFile('data.dat'));
test_signal = abs(loadFile('data2.dat'));

[cs_w, cs_P, cs_f] = filter_signal(control_signal);

[ts_w, ts_P, ts_f] = filter_signal(test_signal);

figure(1)
tiledlayout(2,1)
nexttile
plot(control_signal)
title('Raw Data Control Signal')
xlabel('Time (samples)')
ylabel('Relative Amplitude')
nexttile
plot(test_signal)
title('Raw Exploited Signal')
xlabel('Time (samples)')
ylabel('Relative Amplitude')

figure(2)
tiledlayout(2,1)
nexttile
plot(cs_w)
title('Filtered Control Signal')
xlabel('Time (samples)')
ylabel('Relative Amplitude')
nexttile
plot(ts_w)
title('Filtered Test Signal')
xlabel('Time (samples)')
ylabel('Relative Amplitude')

figure(3)
tiledlayout(2,1)
nexttile
plot(cs_f,cs_P) 
title('Single-Sided Amplitude Spectrum of Control Signal')
xlabel('f (Hz)')
ylabel('|P1(f)|')
nexttile
plot(ts_f,ts_P) 
title('Single-Sided Amplitude Spectrum of Control Signal')
xlabel('f (Hz)')
ylabel('|P1(f)|')

figure(4)
tiledlayout(3,1)
nexttile
plot(control_signal)
hold on
plot(test_signal)
title('Raw Control and Test Signals')
xlabel('Time (samples)')
ylabel('Relative Amplitude')
legend('Control Signal','Test Signal')
hold off
nexttile
plot(cs_w)
hold on
plot(ts_w)
title('Filtered Control and Test Signals')
xlabel('Time (samples)')
ylabel('Relative Amplitude')
legend('Control Signal','Test Signal')
hold off
nexttile
plot(cs_f,cs_P)
hold on
plot(ts_f,ts_P)
title('Single-Sided Amplitude Spectrum of Control and Test Signal')
xlabel('f (Hz)')
ylabel('|P1(f)|')
legend('Control Signal','Test Signal')
hold off