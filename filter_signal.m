function [filtered_graph,amplitude_graph,freq] = filter_signal(signal)

y = resample(signal,5,4);

aa = y - 3;
windowSize = 20; 
b = (1/windowSize)*ones(1,windowSize);
a = 10;
aa = filter(b,a,aa);
aa = aa( aa>=0 );
u = ones(1,1000);
w = conv(u,aa);

w = w -30;
filtered_graph = w;


L = 10000;
Fs = 4e6;
f = Fs*(0:(L/2))/L;
Y = fft(w);
P2 = abs(Y/L);
P1 = P2(1:L/2+1);
P1(2:end-1) = 2*P1(2:end-1);

amplitude_graph = P1;
freq = f;

end